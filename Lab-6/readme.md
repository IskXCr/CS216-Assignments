The fastest implementation is written in `b4.cpp`.